<ion-header *ngIf="showGenres == true">
    <ion-navbar>
        <ion-buttons left>
            <button ion-button icon-only (click)="searchByGenre()">
                    <ion-icon name="md-arrow-round-back"></ion-icon>
            </button>
        </ion-buttons>
        <ion-title *ngIf="selectedGenres.length != 0">Genres ({{selectedGenres.length}} selected)</ion-title>
        <ion-title *ngIf="selectedGenres.length == 0">Genres</ion-title>
    </ion-navbar>
</ion-header>


<ion-content padding>
    <ion-searchbar *ngIf="showGenres == false"
    [(ngModel)]="searchString"
    [showCancelButton]="shouldShowCancel"
    (ionInput)="search()"
    (ionCancel)="clearSearch()"
    placeholder="Search for anime">
    </ion-searchbar>
    <ion-grid *ngIf="selectedGenres.length != 0">
        <ion-row>
            <ion-col col-4 *ngFor="let genre of selectedGenres" class="token">
                {{genre}} <ion-icon float-right name="md-close" (click)="unselectGenre(genre)"></ion-icon>
            </ion-col>
        </ion-row>
    </ion-grid>

    <ion-fab bottom right *ngIf="showGenres == false">
        <button ion-fab style="background-color:#052B2A;">
          <ion-icon name="md-settings"></ion-icon>
        </button>
        <button ion-fab *ngIf="showGenres == true" (click)="searchByGenre()" style="background-color:#052B2A;">
            <ion-icon name="md-arrow-round-back"></ion-icon>
          </button>
        <ion-fab-list side="top">
            <button ion-fab (click)="showCategories()">
                <ion-icon name="md-pricetag"></ion-icon>
                <ion-label>Search by genres</ion-label>
            </button>
          <button ion-fab (click)="changeTitleType()">
            <ion-icon name="md-quote"></ion-icon>
            <ion-label *ngIf="title_type == 'title_english'">English</ion-label>
            <ion-label *ngIf="title_type == 'title_japanese'">Japanese</ion-label>
            <ion-label *ngIf="title_type == 'title_romaji'">Romaji</ion-label>
          </button>
          <button ion-fab (click)="changeOrder()">
            <ng-container *ngIf="order == 'asc'">
                <ion-icon name="md-trending-down"></ion-icon>
                <ion-label>Order A-Z</ion-label>
            </ng-container>
            <ng-container *ngIf="order == 'desc'">
                <ion-icon name="md-trending-up"></ion-icon>
                <ion-label>Order Z-A</ion-label>
            </ng-container>
          </button>
          <button ion-fab (click)="changeNotificationHour()">
              <ion-icon name="md-alarm"></ion-icon>
              <ion-label>Notification hour</ion-label>
          </button>
        </ion-fab-list>
      </ion-fab>

    <ion-list *ngIf="showGenres == true">
      <ng-container *ngFor="let g of genres">
          <ion-item *ngIf="g.selected == false" (click)="selectGenre(g.name)">{{g.name}}</ion-item>
          <ion-item *ngIf="g.selected == true" (click)="unselectGenre(g.name)">{{g.name}}<ion-icon float-right name="md-checkmark-circle"></ion-icon></ion-item>
      </ng-container>
    </ion-list>

    <ion-list *ngIf="searchResults.length == 0 && showGenres == false && searchString == '' && selectedGenres.length == 0">
        <ng-container *ngFor="let a of animes">
            <ion-item *ngIf="title_type == 'title_english'" (click)="moreInfo(a)">{{ (a.title_english.length>40)? (a.title_english | slice:0:40)+'...':(a.title_english) }}</ion-item>
            <ion-item *ngIf="title_type == 'title_japanese'" (click)="moreInfo(a)">{{ (a.title_japanese.length>40)? (a.title_japanese | slice:0:40)+'...':(a.title_japanese) }}</ion-item>
            <ion-item *ngIf="title_type == 'title_romaji'" (click)="moreInfo(a)">{{ (a.title_romaji.length>40)? (a.title_romaji | slice:0:40)+'...':(a.title_romaji) }}</ion-item>
        </ng-container>
    </ion-list>

    <ion-list *ngIf="searchResults.length != 0 && showGenres == false">
      <ng-container *ngFor="let a of searchResults">
          <ion-item *ngIf="title_type == 'title_english'" (click)="moreInfo(a)">{{ (a.title_english.length>40)? (a.title_english | slice:0:40)+'...':(a.title_english) }}</ion-item>
          <ion-item *ngIf="title_type == 'title_japanese'" (click)="moreInfo(a)">{{ (a.title_japanese.length>40)? (a.title_japanese | slice:0:40)+'...':(a.title_japanese) }}</ion-item>
          <ion-item *ngIf="title_type == 'title_romaji'" (click)="moreInfo(a)">{{ (a.title_romaji.length>40)? (a.title_romaji | slice:0:40)+'...':(a.title_romaji) }}</ion-item>
      </ng-container>
    </ion-list>

</ion-content>
